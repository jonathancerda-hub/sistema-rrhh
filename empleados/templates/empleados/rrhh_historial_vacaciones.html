<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Historial Vacaciones - RRHH</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
  <style>
    body{background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh}
    .page{max-width:1200px;margin:32px auto;padding:0 16px}
    .card-ui{background:#fff;border-radius:16px;box-shadow:0 10px 25px rgba(0,0,0,.1);overflow:hidden}
    .card-header{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;padding:16px 20px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}
    .filters .form-control, .filters .form-select{min-width:160px}
    .table thead th{text-transform:uppercase;font-size:.8rem;letter-spacing:.4px;color:#4a5568}
    .estado{border-radius:999px;padding:4px 10px;font-size:.75rem}
    .e-pendiente{background:#fff3cd;color:#856404}
    .e-aprobado{background:#d4edda;color:#155724}
    .e-rechazado{background:#f8d7da;color:#721c24}
    .badge-tipo{border-radius:999px;padding:4px 10px}
  </style>
</head>
<body>
  <div class="page">
    <div class="card-ui">
      <div class="card-header">
        <h4 class="mb-0">Historial de Solicitudes de Vacaciones</h4>
        <a class="btn btn-light" href="{% url 'rrhh_dashboard' %}">Regresar</a>
      </div>
      <div class="px-3 pt-3">
        <form class="row g-2 align-items-end filters" method="get">
          <div class="col-auto">
            <label class="form-label text-muted">Estado</label>
            <select class="form-select" name="estado">
              <option value="">Todos</option>
              <option value="pendiente" {% if f_estado == 'pendiente' %}selected{% endif %}>Pendiente</option>
              <option value="aprobado" {% if f_estado == 'aprobado' %}selected{% endif %}>Aprobado</option>
              <option value="rechazado" {% if f_estado == 'rechazado' %}selected{% endif %}>Rechazado</option>
              <option value="cancelado" {% if f_estado == 'cancelado' %}selected{% endif %}>Cancelado</option>
            </select>
          </div>
          <div class="col-auto">
            <label class="form-label text-muted">Desde</label>
            <input type="date" class="form-control" name="desde" value="{{ f_desde }}">
          </div>
          <div class="col-auto">
            <label class="form-label text-muted">Hasta</label>
            <input type="date" class="form-control" name="hasta" value="{{ f_hasta }}">
          </div>
          <div class="col-auto">
            <button class="btn btn-primary">Filtrar</button>
          </div>
        </form>
      </div>
      <div class="p-3">
        <table class="table table-hover align-middle">
          <thead>
            <tr>
              <th>Empleado</th>
              <th>Área</th>
              <th>Inicio</th>
              <th>Fin</th>
              <th>Días</th>
              <th>Tipo</th>
              <th>Estado</th>
              <th>Resuelto</th>
            </tr>
          </thead>
          <tbody>
            {% for s in solicitudes %}
            <tr>
              <td>{{ s.empleado.nombre }} {{ s.empleado.apellido }}</td>
              <td>{{ s.empleado.puesto }}</td>
              <td>{{ s.fecha_inicio|date:"d/m/Y" }}</td>
              <td>{{ s.fecha_fin|date:"d/m/Y" }}</td>
              <td>{{ s.dias_solicitados }}</td>
              <td><span class="badge bg-secondary">{{ s.get_tipo_vacaciones_display }}</span></td>
              <td>
                <span class="estado {% if s.estado == 'pendiente' %}e-pendiente{% elif s.estado == 'aprobado' %}e-aprobado{% elif s.estado == 'rechazado' %}e-rechazado{% else %}badge bg-light text-dark{% endif %}">
                  {{ s.get_estado_display }}
                </span>
              </td>
              <td>{% if s.fecha_resolucion %}{{ s.fecha_resolucion|date:"d/m/Y H:i" }}{% else %}-{% endif %}</td>
            </tr>
            {% empty %}
            <tr><td colspan="8" class="text-center text-muted py-4">Sin registros</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>

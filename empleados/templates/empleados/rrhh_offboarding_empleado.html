<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Offboarding - RRHH</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .offboarding-section {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .employee-info {
            background-color: #fff;
            border-left: 4px solid #dc3545;
            padding: 15px;
            margin-bottom: 20px;
        }
        .checklist-item {
            padding: 10px;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        .employee-photo {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 50%;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <!-- Header -->
        <div class="row">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <h2><i class="fas fa-user-times text-danger"></i> Proceso de Offboarding</h2>
                        <p class="text-muted">Gestión de baja de empleado</p>
                    </div>
                    <div>
                        <a href="{% url 'rrhh_lista_empleados' %}" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left"></i> Volver a Lista
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Información del Empleado -->
        <div class="employee-info">
            <div class="row">
                <div class="col-md-2 text-center">
                    {% if empleado.foto_perfil %}
                        <img src="{{ empleado.foto_perfil.url }}" alt="Foto" class="employee-photo">
                    {% else %}
                        <div class="employee-photo bg-secondary d-flex align-items-center justify-content-center text-white mx-auto">
                            <i class="fas fa-user fa-2x"></i>
                        </div>
                    {% endif %}
                </div>
                <div class="col-md-10">
                    <h4>{{ empleado.nombre }} {{ empleado.apellido }}</h4>
                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>DNI:</strong> {{ empleado.dni }}</p>
                            <p><strong>Email:</strong> {{ empleado.email }}</p>
                            <p><strong>Puesto:</strong> {{ empleado.puesto }}</p>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Área:</strong> {{ empleado.area|default:"No especificada" }}</p>
                            <p><strong>Fecha de Contratación:</strong> {{ empleado.fecha_contratacion }}</p>
                            <p><strong>Manager:</strong> 
                                {% if empleado.manager %}
                                    {{ empleado.manager.nombre }} {{ empleado.manager.apellido }}
                                {% else %}
                                    Sin manager asignado
                                {% endif %}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <form method="POST">
            {% csrf_token %}
            
            <!-- Datos de la Baja -->
            <div class="offboarding-section">
                <h5><i class="fas fa-file-alt"></i> Información de la Baja</h5>
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="tipo_baja" class="form-label">Tipo de Baja</label>
                            <select class="form-select" id="tipo_baja" name="tipo_baja" required>
                                <option value="">Seleccionar tipo</option>
                                <option value="renuncia">Renuncia Voluntaria</option>
                                <option value="despido">Despido</option>
                                <option value="finalizacion_contrato">Finalización de Contrato</option>
                                <option value="jubilacion">Jubilación</option>
                                <option value="abandono">Abandono de Trabajo</option>
                                <option value="otros">Otros</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="fecha_baja" class="form-label">Fecha de Baja</label>
                            <input type="date" class="form-control" id="fecha_baja" name="fecha_baja" 
                                   value="{{ today|date:'Y-m-d' }}" required>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="mb-3">
                            <label for="motivo" class="form-label">Motivo Detallado</label>
                            <textarea class="form-control" id="motivo" name="motivo" rows="3" 
                                      placeholder="Describa el motivo de la baja..."></textarea>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="mb-3">
                            <label for="observaciones" class="form-label">Observaciones</label>
                            <textarea class="form-control" id="observaciones" name="observaciones" rows="3" 
                                      placeholder="Observaciones adicionales..."></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Checklist de Offboarding -->
            <div class="offboarding-section">
                <h5><i class="fas fa-tasks"></i> Checklist de Offboarding</h5>
                <p class="text-muted">Marque las tareas completadas durante el proceso:</p>
                
                <div class="row">
                    <div class="col-md-6">
                        <h6>Administrativo</h6>
                        <div class="checklist-item">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="entrevista_salida">
                                <label class="form-check-label" for="entrevista_salida">
                                    Entrevista de salida realizada
                                </label>
                            </div>
                        </div>
                        <div class="checklist-item">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="documentos_firmados">
                                <label class="form-check-label" for="documentos_firmados">
                                    Documentos de finiquito firmados
                                </label>
                            </div>
                        </div>
                        <div class="checklist-item">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="liquidacion_calculada">
                                <label class="form-check-label" for="liquidacion_calculada">
                                    Liquidación calculada y aprobada
                                </label>
                            </div>
                        </div>
                        <div class="checklist-item">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="beneficios_cancelados">
                                <label class="form-check-label" for="beneficios_cancelados">
                                    Beneficios y seguros cancelados
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h6>Sistemas y Accesos</h6>
                        <div class="checklist-item">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="accesos_revocados">
                                <label class="form-check-label" for="accesos_revocados">
                                    Accesos a sistemas revocados
                                </label>
                            </div>
                        </div>
                        <div class="checklist-item">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="equipos_devueltos">
                                <label class="form-check-label" for="equipos_devueltos">
                                    Equipos y materiales devueltos
                                </label>
                            </div>
                        </div>
                        <div class="checklist-item">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="email_desactivado">
                                <label class="form-check-label" for="email_desactivado">
                                    Email corporativo desactivado
                                </label>
                            </div>
                        </div>
                        <div class="checklist-item">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="transferencia_responsabilidades">
                                <label class="form-check-label" for="transferencia_responsabilidades">
                                    Responsabilidades transferidas
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Advertencia -->
            <div class="alert alert-warning" role="alert">
                <i class="fas fa-exclamation-triangle"></i>
                <strong>Advertencia:</strong> Este proceso desactivará la cuenta del empleado en el sistema. 
                Asegúrese de que todas las tareas del checklist estén completadas antes de proceder.
            </div>

            <!-- Botones de Acción -->
            <div class="d-flex justify-content-between">
                <div>
                    <button type="submit" class="btn btn-danger" 
                            onclick="return confirm('¿Está seguro de procesar el offboarding de este empleado? Esta acción desactivará su cuenta.')">
                        <i class="fas fa-user-times"></i> Procesar Offboarding
                    </button>
                    <a href="{% url 'rrhh_lista_empleados' %}" class="btn btn-secondary">
                        <i class="fas fa-times"></i> Cancelar
                    </a>
                </div>
                <div>
                    <a href="{% url 'rrhh_editar_empleado' empleado.id %}" class="btn btn-outline-primary">
                        <i class="fas fa-edit"></i> Editar Empleado
                    </a>
                </div>
            </div>
        </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
